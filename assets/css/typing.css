/* =========================================
   1. CORE STYLES & BACKGROUND
   ========================================= */
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    overflow-x: hidden;
    background: #0a2647; /* Nền xanh đậm chủ đạo */
    color: #ffffff;      /* Chữ mặc định màu trắng */
    min-height: 100vh;
}

/* Hiệu ứng nền (Sao, Mây...) */
.hero {
    min-height: 100vh;
    background: linear-gradient(135deg, #0a2647 0%, #1a4d7a 60%, #163a5f 100%);
    position: relative;
    display: flex;
    flex-direction: column;
}

/* Navbar */
nav {
    display: flex; justify-content: space-between; align-items: center;
    padding: 20px 60px; z-index: 100;
    background: rgba(10, 38, 71, 0.8); 
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
.logo { font-size: 28px; font-weight: 800; color: #fff; letter-spacing: -0.5px; }
.nav-links { display: flex; gap: 25px; align-items: center; }
.nav-links a { 
    color: #cbd5e1; text-decoration: none; font-weight: 500; transition: 0.3s; 
}
.nav-links a:hover, .nav-links a.active { color: #38bdf8; }

/* =========================================
   2. LAYOUT CONTAINER & BARS
   ========================================= */
.typing-container {
    width: 90%; max-width: 1000px;
    margin: 20px auto; /* Giảm từ 40px xuống 20px */
    display: flex; flex-direction: column; gap: 25px;
    z-index: 10; position: relative;
}

/* --- THANH MENU (Selection Bar) --- */
.selection-bar {
    display: flex; justify-content: center;
    align-items: center;
    background: rgba(16, 23, 41, 0.6);
    padding: 15px 30px; /* Tăng padding lên */
    border-radius: 20px; /* Bo tròn nhiều hơn chút */
    border: 1px solid rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(8px);
    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    position: relative;
}

.mode-tabs { display: flex; gap: 10px; }

/* Style nút tab (Lessons, Custom...) màu trắng */
.tab-btn {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #e2e8f0;
    padding: 12px 30px; /* Nút to hơn (cũ: 8px 20px) */
    border-radius: 10px;
    cursor: pointer; transition: all 0.3s;
    font-weight: 700; /* Chữ đậm hơn */
    font-size: 16px;  /* Chữ to hơn (cũ: 14px) */
}

.tab-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: #fff;
    color: #fff;
}

.tab-btn.active {
    background: #38bdf8; /* Xanh dương active */
    color: #0f172a;      /* Chữ đen trên nền xanh */
    border-color: #38bdf8;
    box-shadow: 0 0 15px rgba(56, 189, 248, 0.4);
}

/* --- THANH CHỈ SỐ (Stats Bar) --- */
.stats-bar {
    display: flex; justify-content: center; align-items: center; gap: 50px;
    background: rgba(30, 41, 59, 0.5);
    padding: 20px;
    border-radius: 16px;
    border: 1px solid rgba(56, 189, 248, 0.15); /* Viền xanh nhẹ */
    margin-bottom: 10px;
    animation: fadeIn 0.5s ease;
}

.stat-group { text-align: center; }
.stat-label { 
    font-size: 12px; color: #94a3b8; letter-spacing: 1.5px; 
    font-weight: 700; text-transform: uppercase; margin-bottom: 5px;
}
.stat-value { 
    font-size: 42px; font-weight: 800; color: #fff; 
    text-shadow: 0 0 10px rgba(255,255,255,0.3);
    line-height: 1; font-variant-numeric: tabular-nums;
}

/* =========================================
   3. TYPING AREA (KHUNG GÕ)
   ========================================= */
.typing-box-wrapper {
    position: relative;
    background: rgba(15, 23, 42, 0.8); /* Nền rất tối để nổi chữ trắng */
    border-radius: 20px;
    padding: 40px;
    min-height: 220px;
    box-shadow: inset 0 0 40px rgba(0,0,0,0.5);
    border: 2px solid rgba(255, 255, 255, 0.05);
    cursor: text;
    display: flex; align-items: center;
    transition: border-color 0.3s;
}

.typing-box-wrapper:focus-within {
    border-color: #38bdf8; /* Viền sáng khi focus */
    box-shadow: 0 0 20px rgba(56, 189, 248, 0.15), inset 0 0 40px rgba(0,0,0,0.5);
}

/* Nội dung chữ */
.typing-box {
    font-family: 'Roboto Mono', monospace;
    font-size: 28px;
    line-height: 1.6;
    color: #ffffff; /* YÊU CẦU: CHỮ MẪU MÀU TRẮNG */
    width: 100%;
    user-select: none;
    text-shadow: 0 1px 2px rgba(0,0,0,0.8);
}

/* Trạng thái ký tự */
.typing-box span { position: relative; border-radius: 4px; padding: 2px 0; transition: color 0.1s; }

/* YÊU CẦU: GÕ ĐÚNG MÀU XANH LÁ */
.typing-box span.correct { 
    color: #4ade80; 
    text-shadow: 0 0 8px rgba(74, 222, 128, 0.5);
}

/* Gõ sai màu đỏ */
.typing-box span.incorrect { 
    color: #ff6b6b; 
    text-decoration: underline; 
    background: rgba(255, 107, 107, 0.15);
}

/* Con trỏ (Cursor) */
.typing-box span.active { 
    background-color: #38bdf8; 
    color: #0f172a !important; /* Chữ tại con trỏ màu tối */
    box-shadow: 0 0 10px #38bdf8;
}
.typing-box span.active::before {
    content: ''; position: absolute; left: 0; bottom: 0; width: 100%; height: 3px;
    background: #38bdf8; animation: blink 1s infinite;
}

/* Input ẩn (Quan trọng để fix lỗi gõ) */
.input-field {
    position: absolute; opacity: 0; z-index: -1;
    top: 50%; left: 50%; width: 1px; height: 1px;
}

/* Màn hình "Click to Start" */
.focus-overlay {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(10, 38, 71, 0.85);
    backdrop-filter: blur(5px);
    display: flex; align-items: center; justify-content: center;
    border-radius: 20px; z-index: 20;
    cursor: pointer;
    transition: opacity 0.2s;
}
.start-msg {
    font-size: 20px; color: #fff; font-weight: 600;
    display: flex; align-items: center; gap: 10px;
    background: rgba(255,255,255,0.1); padding: 12px 25px; border-radius: 30px;
    border: 1px solid rgba(255,255,255,0.2);
    animation: pulse 2s infinite;
}
@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

/* =========================================
   4. KEYBOARD & CONTROLS
   ========================================= */
.keyboard-container {
    background: rgba(30, 41, 59, 0.6);
    padding: 25px; border-radius: 24px;
    border: 1px solid rgba(255,255,255,0.05);
    margin-top: 20px;
    user-select: none;
}
.keyboard-row { display: flex; justify-content: center; gap: 6px; margin-bottom: 6px; }

.key {
    height: 45px; min-width: 45px;
    background: #1e293b; color: #94a3b8;
    border-radius: 8px; 
    display: flex; align-items: center; justify-content: center;
    font-weight: 600; font-size: 14px;
    border-bottom: 3px solid #0f172a;
    transition: 0.1s;
}
.key.highlight {
    background: #38bdf8; color: #0f172a; border-bottom-color: #0284c7;
    transform: translateY(2px); border-bottom-width: 1px;
    box-shadow: 0 0 15px rgba(56, 189, 248, 0.6);
}
/* Kích thước phím đặc biệt */
.key.space { width: 300px; }
.key.shift { width: 100px; }
.key.enter { width: 90px; }
.key.backspace { width: 90px; }

/* Thanh điều khiển (Select box, Custom Btn) */
.controls-bar {
    display: flex; justify-content: center; gap: 15px; margin-top: 15px;
}
.controls-bar select, .custom-text-btn {
    background: #1e293b; 
    color: #fff; /* Chữ trắng */
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 10px 20px; border-radius: 8px; 
    cursor: pointer; outline: none; font-family: inherit;
}
.controls-bar select:hover, .custom-text-btn:hover {
    border-color: #38bdf8; color: #38bdf8;
}

/* =========================================
   5. LESSON DASHBOARD & MODAL
   ========================================= */
.lesson-dashboard { display: flex; flex-direction: column; gap: 30px; }
.lesson-section {
    background: rgba(16, 23, 41, 0.6);
    border-radius: 16px; padding: 25px;
    border: 1px solid rgba(255,255,255,0.05);
}
.section-title {
    color: #fff; font-size: 22px; margin-bottom: 20px;
    border-left: 4px solid #38bdf8; padding-left: 15px;
}
.section-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }

.lesson-card {
    background: #1e293b;
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 12px; padding: 20px; cursor: pointer;
    transition: 0.3s;
}
.lesson-card:hover {
    transform: translateY(-5px);
    border-color: #38bdf8;
    background: #253346;
}
.lesson-info h3 { color: #fff; font-size: 16px; margin-bottom: 5px; }
.lesson-info p { color: #94a3b8; font-size: 13px; }

/* Modal Custom Text */
.modal {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.85); z-index: 2000;
    display: none; align-items: center; justify-content: center;
}
.modal.active { display: flex; }

.modal-content {
    background: #1e293b; /* Nền Modal tối */
    padding: 30px; border-radius: 16px; width: 500px;
    border: 1px solid rgba(255,255,255,0.1);
    box-shadow: 0 20px 50px rgba(0,0,0,0.5);
}

.modal h3 { color: #fff; margin-bottom: 15px; }

/* YÊU CẦU: TEXTAREA CHỮ TRẮNG */
.modal textarea {
    width: 100%; height: 150px;
    background: #0f172a; 
    color: #fff; 
    border: 1px solid #334155;
    padding: 15px; border-radius: 8px;
    resize: none; font-family: inherit; outline: none;
}
.modal textarea:focus { border-color: #38bdf8; }

.modal-btns { display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px; }
.cta-button {
    background: #38bdf8; color: #0f172a; border: none;
    padding: 10px 25px; border-radius: 8px; font-weight: 700; cursor: pointer;
}
.btn-secondary {
    background: transparent; border: 1px solid rgba(255,255,255,0.2);
    color: #fff; padding: 10px 20px; border-radius: 8px; cursor: pointer;
}

@keyframes blink { 50% { opacity: 0; } }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
/* =========================================
   FIX LỖI RESULT OVERLAY (BẢNG KẾT QUẢ)
   ========================================= */

/* 1. Lớp phủ toàn màn hình */
.result-overlay {
    position: fixed; /* Bắt buộc dùng fixed để nổi lên trên cùng */
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 100%;
    background: rgba(10, 38, 71, 0.95); /* Nền tối làm mờ phía sau */
    z-index: 9999; /* Z-index cao nhất để không bị che */
    display: none; /* Mặc định ẩn */
    flex-direction: column;
    align-items: center; 
    justify-content: center;
    backdrop-filter: blur(10px); /* Hiệu ứng mờ kính */
}

/* Khi có class active (được thêm bằng JS) thì hiện lên */
.result-overlay.active {
    display: flex !important;
    animation: zoomIn 0.3s ease;
}

/* 2. Hộp chứa nội dung kết quả (Cái thẻ ở giữa) */
.result-card {
    background: #1e293b; /* Nền xám xanh đậm */
    width: 90%;
    max-width: 450px; /* Giới hạn chiều rộng để không bị bè ra */
    padding: 40px;
    border-radius: 24px;
    text-align: center;
    border: 1px solid rgba(56, 189, 248, 0.3); /* Viền xanh sáng */
    box-shadow: 0 20px 60px rgba(0,0,0,0.6); /* Đổ bóng sâu */
}

/* Tiêu đề "Great Job" */
.result-card h2 {
    font-size: 32px;
    font-weight: 800;
    color: #4ade80; /* Màu xanh lá (Green Neon) */
    margin-bottom: 30px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

/* Khu vực hiển thị chỉ số WPM / ACC */
.result-stats {
    display: flex;
    justify-content: center;
    gap: 40px;
    margin-bottom: 40px;
}

.res-item {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.big-num {
    font-size: 64px;
    font-weight: 800;
    color: #fff;
    line-height: 1;
    margin-bottom: 10px;
    text-shadow: 0 0 20px rgba(56, 189, 248, 0.4);
}

.res-item span {
    font-size: 14px;
    color: #94a3b8;
    text-transform: uppercase;
    font-weight: 700;
    letter-spacing: 1px;
}

/* 3. Các nút bấm (Next Lesson, Retry, Menu) */
.result-actions {
    display: flex;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
    width: 100%;
}

.cta-button {
    background: #38bdf8;
    color: #0f172a;
    border: none;
    padding: 12px 30px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 16px;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    display: flex; align-items: center; gap: 8px;
}

.cta-button:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(56, 189, 248, 0.3);
}

.btn-secondary {
    background: transparent;
    color: #cbd5e1;
    border: 1px solid rgba(255,255,255,0.2);
    padding: 12px 20px;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: 0.2s;
    display: flex; align-items: center; gap: 8px;
}

.btn-secondary:hover {
    background: rgba(255,255,255,0.1);
    color: #fff;
    border-color: #fff;
}

/* Hiệu ứng hiện ra */
@keyframes zoomIn {
    from { transform: scale(0.8); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}
/* ... Giữ nguyên phần đầu ... */

/* --- SỬA MENU (Yêu cầu 1) --- */
.selection-bar {
    display: flex; justify-content: center; /* Canh giữa tabs */
    align-items: center;
    background: rgba(16, 23, 41, 0.6);
    padding: 12px 25px;
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(8px);
    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    position: relative;
}

.mode-tabs { display: flex; gap: 15px; width: 100%; justify-content: space-around; }
.tab-btn { flex: 1; text-align: center; } /* Chia đều khoảng cách */

/* --- NÚT BACK TÁCH RIÊNG (Yêu cầu 6) --- */
.back-nav-container {
    height: 40px;
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    /* Đảm bảo container không bị ẩn */
    min-height: 40px; 
}

.back-btn-isolated {
    background: transparent;
    border: none;
    color: #94a3b8;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    display: flex; align-items: center; gap: 8px;
    transition: 0.3s;
    padding: 5px 0;
}

.back-btn-isolated:hover {
    color: #38bdf8;
    transform: translateX(-5px);
}

/* --- NGÔI SAO MÀU VÀNG (Yêu cầu 7) --- */
.lesson-stars {
    display: flex;
    gap: 4px; /* Giãn cách */
    font-size: 12px;
}
.lesson-stars i {
    color: #334155; /* Sao chưa đạt màu tối */
    transition: 0.3s;
}
.lesson-stars i.fas {
    color: #ffd700; /* Sao đạt được màu vàng gold */
    text-shadow: 0 0 5px rgba(255, 215, 0, 0.4);
}

/* ... Giữ nguyên phần còn lại ... */

/* Thêm style cho thẻ bài học dạng Code (nếu cần chỉnh riêng) */
.lesson-card.code-card {
    border-left: 4px solid #a855f7; /* Màu tím cho code */
}
.lesson-card.test-card {
    border-left: 4px solid #ef4444; /* Màu đỏ cho test */
}
.result-actions button {
    display: flex; /* Để icon căn chỉnh đẹp */
}
#customPanel {
    max-width: 700px;
    margin: 0 auto;
    display: none;
    text-align: center;
}

#customPanel .section-title {
    border: none;
    padding: 0;
    text-align: center;
    margin-bottom: 30px;
    color: #38bdf8;
    text-transform: uppercase;
    letter-spacing: 1px;
}

#customPanel p {
    color: #94a3b8;
    margin-bottom: 25px;
    font-size: 16px;
}

.custom-box {
    background: rgba(16, 23, 41, 0.6);
    padding: 40px;
    border-radius: 16px;
    display: flex;           /* Dùng flexbox */
    flex-direction: column;  /* Xếp dọc */
    align-items: center;     /* Căn giữa theo chiều ngang (Quan trọng) */
    justify-content: center;
    gap: 20px;               /* Khoảng cách giữa chữ và nút */
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.custom-box .cta-button {
    width: auto;
    min-width: 150px;
    justify-content: center;
}

.nav-controls {
    display: flex;
    gap: 15px; /* Khoảng cách giữa nút Menu và Restart */
}

.nav-control-btn {
    background: transparent;
    border: none;
    color: #94a3b8;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    display: flex; align-items: center; gap: 8px;
    transition: 0.3s;
    padding: 5px 10px;
    border-radius: 8px;
}

.nav-control-btn:hover {
    color: #38bdf8;
    background: rgba(56, 189, 248, 0.1);
    transform: translateY(-2px);
}

/* Style riêng cho nút Restart (màu vàng hoặc cam để nổi bật) */
.refresh-btn:hover {
    color: #fbbf24; /* Màu vàng cam */
    background: rgba(251, 191, 36, 0.1);
}